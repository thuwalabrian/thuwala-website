{% extends "base.html" %}

{% block title %}{{ 'Edit' if service else 'Add' }} Service - Admin Dashboard{% endblock %}

{% block content %}
<div class="admin-container">
    <!-- Sidebar -->
    <aside class="admin-sidebar" id="adminSidebar">
        <div class="sidebar-header">
            <h1>Thuwala Admin</h1>
            <p>Services Management</p>
        </div>
        
        <div class="sidebar-user">
            <div class="user-avatar">
                {{ current_user.username[0]|upper }}
            </div>
            <div class="user-info">
                <h3>{{ current_user.username }}</h3>
                <p>Administrator</p>
            </div>
        </div>
        
        <nav class="sidebar-nav">
            <div class="nav-section">
                <h3>Main</h3>
                <a href="{{ url_for('admin_dashboard') }}" 
                   class="nav-item {% if request.endpoint == 'admin_dashboard' %}active{% endif %}">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </div>
            
            <div class="nav-section">
                <h3>Content Management</h3>
                <a href="{{ url_for('admin_services') }}" 
                   class="nav-item {% if request.endpoint == 'admin_services' %}active{% endif %}">
                    <i class="fas fa-cogs"></i>
                    <span>Services</span>
                </a>
                <a href="{{ url_for('admin_portfolio') }}" 
                   class="nav-item {% if request.endpoint == 'admin_portfolio' %}active{% endif %}">
                    <i class="fas fa-briefcase"></i>
                    <span>Portfolio</span>
                </a>
            </div>
            
            <div class="nav-section">
                <h3>System</h3>
                <a href="{{ url_for('admin_users') }}" 
                   class="nav-item {% if request.endpoint == 'admin_users' %}active{% endif %}">
                    <i class="fas fa-users"></i>
                    <span>Users</span>
                </a>
                <a href="{{ url_for('change_password') }}" class="nav-item">
                    <i class="fas fa-key"></i>
                    <span>Change Password</span>
                </a>
            </div>
        </nav>
        
        <div class="sidebar-footer">
            <a href="{{ url_for('admin_logout') }}" class="btn btn-danger btn-sm">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="admin-main">
        <!-- Mobile Menu Toggle -->
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Header -->
        <header class="admin-header">
            <div class="header-title">
                <h1>{{ 'Edit Service' if service else 'Add New Service' }}</h1>
                <p>{{ 'Update service details' if service else 'Create a new service for your website' }}</p>
            </div>
            <div class="header-actions">
                <a href="{{ url_for('admin_services') }}" class="header-btn">
                    <i class="fas fa-arrow-left"></i> Back to Services
                </a>
            </div>
        </header>

        <!-- Form Container -->
        <div class="form-container">
            <div class="form-layout">
                <!-- Left Column: Form -->
                <div class="form-column">
                    <form method="POST" class="modern-form">
                        <!-- Basic Information Card -->
                        <div class="form-card">
                            <div class="form-card-header">
                                <h2><i class="fas fa-info-circle"></i> Basic Information</h2>
                                <p class="form-card-subtitle">Required service details</p>
                            </div>
                            <div class="form-card-body">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="title" class="form-label">
                                            <i class="fas fa-heading"></i> Service Title *
                                        </label>
                                        <input type="text" 
                                               id="title" 
                                               name="title" 
                                               value="{{ service.title if service else '' }}" 
                                               required 
                                               class="form-input"
                                               placeholder="e.g., Administrative Support"
                                               data-preview="title">
                                        <div class="form-hint">Clear and descriptive title</div>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="category" class="form-label">
                                            <i class="fas fa-tag"></i> Category *
                                        </label>
                                        <select id="category" name="category" required class="form-select" data-preview="category">
                                            <option value="">Select a category</option>
                                            {% for cat in categories %}
                                            <option value="{{ cat }}" 
                                                    {% if service and service.category == cat %}selected{% endif %}>
                                                {{ cat|title }}
                                            </option>
                                            {% endfor %}
                                        </select>
                                        <div class="form-hint">Choose the appropriate category</div>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label for="description" class="form-label">
                                        <i class="fas fa-align-left"></i> Short Description *
                                    </label>
                                    <textarea id="description" 
                                              name="description" 
                                              rows="3" 
                                              required 
                                              class="form-textarea"
                                              placeholder="Brief description displayed on service cards"
                                              data-preview="description">{{ service.description if service else '' }}</textarea>
                                    <div class="form-hint">Keep it concise (1-2 sentences)</div>
                                </div>

                                <div class="form-group">
                                    <label for="icon" class="form-label">
                                        <i class="fas fa-icons"></i> FontAwesome Icon *
                                    </label>
                                    <div class="icon-selector">
                                        <input type="text" 
                                               id="icon" 
                                               name="icon" 
                                               value="{{ service.icon if service else 'fas fa-cogs' }}" 
                                               required 
                                               class="form-input"
                                               placeholder="fas fa-icon-name"
                                               data-preview="icon">
                                        <div class="icon-preview">
                                            <i id="iconPreview" class="{{ service.icon if service else 'fas fa-cogs' }}"></i>
                                        </div>
                                    </div>
                                    <div class="form-hint">Use FontAwesome 5 icon classes</div>
                                </div>

                                <div class="form-group">
                                    <label for="details" class="form-label">
                                        <i class="fas fa-file-alt"></i> Service Details
                                    </label>
                                    <textarea id="details" 
                                              name="details" 
                                              rows="6" 
                                              class="form-textarea"
                                              placeholder="Detailed description of the service. Use bullet points or paragraphs.">{{ service.details if service else '' }}</textarea>
                                    <div class="form-hint">This appears on the service details page</div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-save"></i> {{ 'Update Service' if service else 'Add Service' }}
                            </button>
                            <a href="{{ url_for('admin_services') }}" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </a>
                            {% if service %}
                            <a href="{{ url_for('delete_service', service_id=service.id) }}" 
                               class="btn btn-danger ml-auto"
                               onclick="return confirm('Are you sure you want to delete this service?')">
                                <i class="fas fa-trash"></i> Delete
                            </a>
                            {% endif %}
                        </div>
                    </form>
                </div>

                <!-- Right Column: Preview -->
                <div class="preview-column">
                    <div class="preview-card">
                        <div class="preview-card-header">
                            <h3><i class="fas fa-eye"></i> Live Preview</h3>
                            <p>See how your service will appear</p>
                        </div>
                        
                        <div class="preview-content">
                            <div class="service-preview">
                                <div class="preview-icon">
                                    <i id="previewIcon" class="{{ service.icon if service else 'fas fa-cogs' }}"></i>
                                </div>
                                <h4 id="previewTitle">{{ service.title if service else 'Service Title' }}</h4>
                                <p id="previewDescription">{{ service.description if service else 'Service description will appear here...' }}</p>
                                <div class="preview-category">
                                    <i class="fas fa-tag"></i>
                                    <span id="previewCategory">{{ service.category if service else 'Category' }}</span>
                                </div>
                            </div>
                            
                            <!-- Icon Gallery -->
                            <div class="icon-gallery">
                                <h4><i class="fas fa-icons"></i> Icon Suggestions</h4>
                                <div class="icons-grid">
                                    <div class="icon-option" data-icon="fas fa-clipboard-check">
                                        <i class="fas fa-clipboard-check"></i>
                                        <span>Clipboard</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-chart-bar">
                                        <i class="fas fa-chart-bar"></i>
                                        <span>Chart</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-bullhorn">
                                        <i class="fas fa-bullhorn"></i>
                                        <span>Bullhorn</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-palette">
                                        <i class="fas fa-palette"></i>
                                        <span>Palette</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-briefcase">
                                        <i class="fas fa-briefcase"></i>
                                        <span>Briefcase</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-cogs">
                                        <i class="fas fa-cogs"></i>
                                        <span>Cogs</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-graduation-cap">
                                        <i class="fas fa-graduation-cap"></i>
                                        <span>Graduation</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-lightbulb">
                                        <i class="fas fa-lightbulb"></i>
                                        <span>Lightbulb</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-chess">
                                        <i class="fas fa-chess"></i>
                                        <span>Chess</span>
                                    </div>
                                    <div class="icon-option" data-icon="fas fa-rocket">
                                        <i class="fas fa-rocket"></i>
                                        <span>Rocket</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<script>
// This function will be handled by admin.js
document.addEventListener('DOMContentLoaded', function() {
    // Admin.js handles the initialization
});
</script>
{% endblock %}